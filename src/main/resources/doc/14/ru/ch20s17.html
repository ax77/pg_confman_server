<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>20.17. Параметры для разработчиков</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"/></head><body><div class="sect1"><div class="titlepage"><div><div><h1 class="title"><a id="runtime-config-developer"/>20.17. Параметры для разработчиков</h1></div></div></div><p>Следующие параметры предназначены для тестирования в процессе разработки, и их никогда не следует применять в производственной среде. (Однако в некоторых случаях они могут помочь восстановить сильно повреждённые базы данных.) По этим причинам они отсутствуют в примере файла <code class="filename">postgresql.conf</code>. Заметьте, что для использования многих из этих параметров требуются специальные флаги компиляции.</p><div class="variablelist"><dl class="variablelist"><dt><a id="guc-allow-in-place-tablespaces"/><span class="term"><code class="varname">allow_in_place_tablespaces</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.1.1.3" class="indexterm"/></span></dt><dd><p>Позволяет создавать табличные пространства как каталоги в <code class="filename">pg_tblspc</code>, когда в команде <span class="command"><strong>CREATE TABLESPACE</strong></span> не указано расположение каталога. Это предназначено для тестирования сценариев репликации, когда ведущий и ведомый серверы работают на одном компьютере. Средства резервного копирования ожидают получить символические ссылки в этом месте, поэтому их работа может нарушиться. Изменять этот параметр могут только суперпользователи.</p></dd><dt><a id="guc-allow-system-table-mods"/><span class="term"><code class="varname">allow_system_table_mods</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.2.1.3" class="indexterm"/></span></dt><dd><p>Разрешает модификации структуры системных таблиц, а также некоторые другие потенциально опасные операции с системными таблицами. Если данный параметр отключён, эти действия не разрешены даже суперпользователям. Непродуманное использование этого параметра чревато неисправимыми повреждениями данных и разрушением всей СУБД. Изменить этот параметр могут только суперпользователи.</p></dd><dt><a id="guc-backtrace-functions"/><span class="term"><code class="varname">backtrace_functions</code> (<code class="type">string</code>) <a id="id-1.6.7.20.3.3.1.3" class="indexterm"/></span></dt><dd><p>В этом параметре задаётся разделённый запятыми список имён функций C. В случае возникновения ошибки в функции, имя которой присутствует в этом списке, в журнал сервера помимо сообщения об ошибке будет выводиться трассировка стека. Это может быть полезно для отладки в определённых местах исходного кода.</p><p>Поддержка трассировки стека имеется не на всех платформах, а информационная ценность трассировки зависит от параметров компиляции.</p><p>Этот параметр могут изменять только суперпользователи.</p></dd><dt><a id="guc-debug-discard-caches"/><span class="term"><code class="varname">debug_discard_caches</code> (<code class="type">integer</code>) <a id="id-1.6.7.20.3.4.1.3" class="indexterm"/></span></dt><dd><p>Если установлено значение <code class="literal">1</code>, каждая запись кеша системного каталога становится недействительной при первой же возможности, независимо от того, произошло ли на самом деле что-то, что могло бы сделать её недействительной. В результате кеширование системных каталогов фактически отключается, поэтому сервер будет работать очень медленно. При увеличении значения этого параметра аннулирование кеша производится рекурсивно, что приводит к ещё большему замедлению и полезно только для тестирование собственно логики кеширования. Значение по умолчанию — <code class="literal">0</code> — включает обычное поведение кеширования каталога.</p><p>Этот параметр может быть очень полезен при выявлении трудновоспроизводимых ошибок, связанных с одновременными изменениями в каталоге, но редко бывает нужен в других случаях. Подробнее он описан в файлах исходного кода <code class="filename">visible.c</code> и <code class="filename">pg_config_manual.h</code>.</p><p>Этот параметр поддерживается, если при компиляции был определён макрос <code class="symbol">DISCARD_CACHES_ENABLED</code> (он определяется автоматически при выполнении <span class="application">configure</span> с ключом <code class="option">--enable-cassert</code>). В обычных сборках его значение всегда будет <code class="literal">0</code>; при попытке изменить это значение возникнет ошибка.</p></dd><dt><a id="guc-force-parallel-mode"/><span class="term"><code class="varname">force_parallel_mode</code> (<code class="type">enum</code>) <a id="id-1.6.7.20.3.5.1.3" class="indexterm"/></span></dt><dd><p>Позволяет распараллеливать запрос в целях тестирования, даже когда от этого не ожидается никакого выигрыша в скорости. Допустимые значения параметра <code class="varname">force_parallel_mode</code> — <code class="literal">off</code> (использовать параллельный режим только когда ожидается увеличение производительности), <code class="literal">on</code> (принудительно распараллеливать все запросы, для которых это безопасно) и <code class="literal">regress</code> (как <code class="literal">on</code>, но с дополнительными изменениями поведения, описанными ниже).</p><p>Говоря точнее, со значением <code class="literal">on</code> узел <code class="literal">Gather</code> добавляется в вершину любого плана запроса, для которого допускается распараллеливание, так что запрос выполняется внутри параллельного исполнителя. Даже когда параллельный исполнитель недоступен или не может быть использован, такие операции, как запуск подтранзакции, которые не должны выполняться в контексте параллельного запроса, не будут выполняться в этом режиме, если только планировщик не решит, что это приведёт к ошибке запроса. Если при включении этого параметра возникают ошибки или выдаются неожиданные результаты, вероятно, некоторые функции, задействованные в этом запросе, нужно пометить как <code class="literal">PARALLEL UNSAFE</code> (или, возможно, <code class="literal">PARALLEL RESTRICTED</code>).</p><p>Значение <code class="literal">regress</code> действует так же, как и значение <code class="literal">on</code>, с некоторыми дополнительными особенностями, предназначенными для облегчения автоматического регрессионного тестирования. Обычно сообщения от параллельных исполнителей включают строку контекста, отмечающую это, но значение <code class="literal">regress</code> подавляет эту строку, так что вывод не отличается от выполнения в не параллельном режиме. Кроме того, узлы <code class="literal">Gather</code>, добавляемые в планы с этим значением параметра, скрываются в выводе <code class="literal">EXPLAIN</code>, чтобы вывод соответствовал тому, что будет получен при отключении этого параметра (со значением <code class="literal">off</code>).</p></dd><dt><a id="guc-ignore-system-indexes"/><span class="term"><code class="varname">ignore_system_indexes</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.6.1.3" class="indexterm"/></span></dt><dd><p>Отключает использование индексов при чтении системных таблиц (при этом индексы всё же будут изменяться при записи в эти таблицы). Это полезно для восстановления работоспособности при повреждённых системных индексах. Этот параметр нельзя изменить после запуска сеанса.</p></dd><dt><a id="guc-post-auth-delay"/><span class="term"><code class="varname">post_auth_delay</code> (<code class="type">integer</code>) <a id="id-1.6.7.20.3.7.1.3" class="indexterm"/></span></dt><dd><p>Этот параметр задаёт задержку при запуске нового серверного процесса после выполнения процедуры аутентификации. Он предназначен для того, чтобы разработчики имели возможность подключить отладчик к серверному процессу. Если это значение задаётся без единиц измерения, оно считается заданным в секундах. При нулевом значении (по умолчанию) задержка отсутствует. Этот параметр нельзя изменить после начала сеанса.</p></dd><dt><a id="guc-pre-auth-delay"/><span class="term"><code class="varname">pre_auth_delay</code> (<code class="type">integer</code>) <a id="id-1.6.7.20.3.8.1.3" class="indexterm"/></span></dt><dd><p>Этот параметр задаёт задержку, добавляемую сразу после порождения нового серверного процесса, до выполнения процедуры аутентификации. Он предназначен для того, чтобы разработчики имели возможность подключить отладчик к серверному процессу при решении проблем с аутентификацией. Если это значение задаётся без единиц измерения, оно считается заданным в секундах. При нулевом значении (по умолчанию) задержка отсутствует. Задать этот параметр можно только в <code class="filename">postgresql.conf</code> или в командной строке при запуске сервера.</p></dd><dt><a id="guc-trace-notify"/><span class="term"><code class="varname">trace_notify</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.9.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод очень подробной отладочной информации при выполнении команд <span class="command"><strong>LISTEN</strong></span> и <span class="command"><strong>NOTIFY</strong></span>. Чтобы эти сообщения передавались клиенту или в журнал сервера, параметр <a class="xref" href="ch20s11.html#guc-client-min-messages">client_min_messages</a> или <a class="xref" href="ch20s08.html#guc-log-min-messages">log_min_messages</a>, соответственно, должен иметь значение <code class="literal">DEBUG1</code> или ниже.</p></dd><dt><a id="guc-trace-recovery-messages"/><span class="term"><code class="varname">trace_recovery_messages</code> (<code class="type">enum</code>) <a id="id-1.6.7.20.3.10.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод в журнал отладочных сообщений, связанных с восстановлением, которые иначе не выводятся. Этот параметр позволяет пользователю переопределить обычное значение <a class="xref" href="ch20s08.html#guc-log-min-messages">log_min_messages</a>, но только для специфических сообщений. Он предназначен для отладки режима горячего резерва. Допустимые значения: <code class="literal">DEBUG5</code>, <code class="literal">DEBUG4</code>, <code class="literal">DEBUG3</code>, <code class="literal">DEBUG2</code>, <code class="literal">DEBUG1</code> и <code class="literal">LOG</code>. Значение по умолчанию, <code class="literal">LOG</code>, никак не влияет на запись этих сообщений в журнал. С другими значениями отладочные сообщения, связанные с восстановлением, имеющие заданный приоритет или выше, выводятся, как если бы они имели приоритет <code class="literal">LOG</code>; при стандартных значениях <code class="varname">log_min_messages</code> это означает, что они будут фиксироваться в журнале сервера. Задать этот параметр можно только в <code class="filename">postgresql.conf</code> или в командной строке при запуске сервера.</p></dd><dt><a id="guc-trace-sort"/><span class="term"><code class="varname">trace_sort</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.11.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод информации об использовании ресурсов во время операций сортировки. Этот параметр доступен, только если при сборке <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">TRACE_SORT</code>. (По умолчанию макрос <code class="symbol">TRACE_SORT</code> определён.)</p></dd><dt><span class="term"><code class="varname">trace_locks</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.12.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод подробных сведений о блокировках. В эти сведения входит вид операции блокировки, тип блокировки и уникальный идентификатор объекта, который блокируется или разблокируется. Кроме того, в их составе выводятся битовые маски для типов блокировок, уже полученных для данного объекта, и для типов блокировок, ожидающих его освобождения. В дополнение к этому выводится количество полученных и ожидающих блокировок для каждого типа блокировок, а также их общее количество. Ниже показан пример вывода в журнал: </p><pre class="screen">
LOG:  LockAcquire: new: lock(0xb7acd844) id(24688,24696,0,0,0,1)
      grantMask(0) req(0,0,0,0,0,0,0)=0 grant(0,0,0,0,0,0,0)=0
      wait(0) type(AccessShareLock)
LOG:  GrantLock: lock(0xb7acd844) id(24688,24696,0,0,0,1)
      grantMask(2) req(1,0,0,0,0,0,0)=1 grant(1,0,0,0,0,0,0)=1
      wait(0) type(AccessShareLock)
LOG:  UnGrantLock: updated: lock(0xb7acd844) id(24688,24696,0,0,0,1)
      grantMask(0) req(0,0,0,0,0,0,0)=0 grant(0,0,0,0,0,0,0)=0
      wait(0) type(AccessShareLock)
LOG:  CleanUpLock: deleting: lock(0xb7acd844) id(24688,24696,0,0,0,1)
      grantMask(0) req(0,0,0,0,0,0,0)=0 grant(0,0,0,0,0,0,0)=0
      wait(0) type(INVALID)
</pre><p> Подробнее о структуре выводимой информации можно узнать в <code class="filename">src/include/storage/lock.h</code>.</p><p>Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">LOCK_DEBUG</code>.</p></dd><dt><span class="term"><code class="varname">trace_lwlocks</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.13.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод информации об использовании легковесных блокировок. Такие блокировки предназначены в основном для взаимоисключающего доступа к общим структурам данных в памяти.</p><p>Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">LOCK_DEBUG</code>.</p></dd><dt><span class="term"><code class="varname">trace_userlocks</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.14.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод информации об использовании пользовательских блокировок. Она выводится в том же формате, что и с <code class="symbol">trace_locks</code>, но по рекомендательным блокировкам.</p><p>Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">LOCK_DEBUG</code>.</p></dd><dt><span class="term"><code class="varname">trace_lock_oidmin</code> (<code class="type">integer</code>) <a id="id-1.6.7.20.3.15.1.3" class="indexterm"/></span></dt><dd><p>Если этот параметр установлен, при трассировке блокировок не будут отслеживаться таблицы с OID меньше заданного (это используется для исключения из трассировки системных таблиц).</p><p>Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">LOCK_DEBUG</code>.</p></dd><dt><span class="term"><code class="varname">trace_lock_table</code> (<code class="type">integer</code>) <a id="id-1.6.7.20.3.16.1.3" class="indexterm"/></span></dt><dd><p>Безусловно трассировать блокировки для таблицы с заданным OID.</p><p>Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">LOCK_DEBUG</code>.</p></dd><dt><span class="term"><code class="varname">debug_deadlocks</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.17.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод информации обо всех текущих блокировках при тайм-ауте взаимоблокировки.</p><p>Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">LOCK_DEBUG</code>.</p></dd><dt><span class="term"><code class="varname">log_btree_build_stats</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.18.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод статистики использования системных ресурсов (памяти и процессора) при различных операциях с B-деревом.</p><p>Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">BTREE_BUILD_STATS</code>.</p></dd><dt><a id="guc-wal-consistency-checking"/><span class="term"><code class="varname">wal_consistency_checking</code> (<code class="type">string</code>) <a id="id-1.6.7.20.3.19.1.3" class="indexterm"/></span></dt><dd><p>Этот параметр предназначен для проверки ошибок в процедурах воспроизведения WAL. Когда он включён, в записи WAL добавляются полные образы страниц всех изменяемых буферов, Когда запись впоследствии воспроизводится, система сначала применяет эту запись, а затем проверяет, соответствуют ли буферы, изменённые записью, сохранённым образам. В определённых случаях (например, во вспомогательных битах) небольшие изменения допускаются и будут игнорироваться. Если выявляются неожиданные различия, это считается критической ошибкой и восстановление прерывается.</p><p>По умолчанию значение этого параметра — пустая строка, так что эта функциональность отключена. Его значением может быть <code class="literal">all</code> (будут проверяться все записи) или список имён менеджеров ресурсов через запятую (будут проверяться записи, выдаваемые этими менеджерами). В настоящее время поддерживаются менеджеры <code class="literal">heap</code>, <code class="literal">heap2</code>, <code class="literal">btree</code>, <code class="literal">hash</code>, <code class="literal">gin</code>, <code class="literal">gist</code>, <code class="literal">sequence</code>, <code class="literal">spgist</code>, <code class="literal">brin</code> и <code class="literal">generic</code>. Изменять этот параметр могут только суперпользователи.</p></dd><dt><a id="guc-wal-debug"/><span class="term"><code class="varname">wal_debug</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.20.1.3" class="indexterm"/></span></dt><dd><p>Включает вывод отладочной информации, связанной с WAL. Этот параметр доступен, только если при компиляции <span class="productname">PostgreSQL</span> был определён макрос <code class="symbol">WAL_DEBUG</code>.</p></dd><dt><a id="guc-ignore-checksum-failure"/><span class="term"><code class="varname">ignore_checksum_failure</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.21.1.3" class="indexterm"/></span></dt><dd><p>Этот параметр действует, только если включён <a class="xref" href="rn03re273.html#app-initdb-data-checksums">Контрольные суммы данных</a>.</p><p>При обнаружении ошибок контрольных сумм при чтении <span class="productname">PostgreSQL</span> обычно сообщает об ошибке и прерывает текущую транзакцию. Если параметр <code class="varname">ignore_checksum_failure</code> включён, система игнорирует проблему (но всё же предупреждает о ней) и продолжает обработку. Это поведение может <span class="emphasis"><em>привести к краху, распространению или сокрытию повреждения данных и другим серьёзными проблемам</em></span>. Однако включив его, вы можете обойти ошибку и получить неповреждённые данные, которые могут находиться в таблице, если цел заголовок блока. Если же повреждён заголовок, будет выдана ошибка, даже когда этот параметр включён. По умолчанию этот параметр отключён (имеет значение <code class="literal">off</code>) и изменить его состояние может только суперпользователь.</p></dd><dt><a id="guc-zero-damaged-pages"/><span class="term"><code class="varname">zero_damaged_pages</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.22.1.3" class="indexterm"/></span></dt><dd><p>При выявлении повреждённого заголовка страницы <span class="productname">PostgreSQL</span> обычно сообщает об ошибке и прерывает текущую транзакцию. Если параметр <code class="varname">zero_damaged_pages</code> включён, вместо этого система выдаёт предупреждение, обнуляет повреждённую страницу в памяти и продолжает обработку. Это поведение <span class="emphasis"><em>разрушает данные</em></span>, а именно все строки в повреждённой странице. Однако включив его, вы можете обойти ошибку и получить строки из неповреждённых страниц, которые могут находиться в таблице. Это бывает полезно для восстановления данных, испорченных в результате аппаратной или программной ошибки. Обычно включать его следует только тогда, когда не осталось никакой другой надежды на восстановление данных в повреждённых страницах таблицы. Обнулённые страницы не сохраняются на диск, поэтому прежде чем выключать этот параметр, рекомендуется пересоздать проблемные таблицы или индексы. По умолчанию этот параметр отключён (имеет значение <code class="literal">off</code>) и изменить его состояние может только суперпользователь.</p></dd><dt><a id="guc-ignore-invalid-pages"/><span class="term"><code class="varname">ignore_invalid_pages</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.23.1.3" class="indexterm"/></span></dt><dd><p>Когда этот параметр имеет значение <code class="literal">off</code> (по умолчанию), обнаружение в WAL записей, ссылающихся на некорректные страницы, в процессе восстановления приводит к остановке <span class="productname">PostgreSQL</span> с ошибкой критического уровня и, как следствие, к прерыванию восстановления. Когда параметр <code class="varname">ignore_invalid_pages</code> включён (<code class="literal">on</code>), система игнорирует подобные недействительные ссылки в записях WAL (но всё же выдаёт предупреждения) и продолжает восстановление. Это поведение может <span class="emphasis"><em>привести к краху, потере данных, распространению или сокрытию повреждения данных и другим серьёзными проблемам</em></span>. Однако включив этот параметр, вы можете обойти критическую ошибку и закончить восстановление, чтобы сервер всё же запустился. Задать этот параметр можно только при запуске сервера. Действует он только при восстановлении или в режиме ведомого.</p></dd><dt><a id="guc-jit-debugging-support"/><span class="term"><code class="varname">jit_debugging_support</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.24.1.3" class="indexterm"/></span></dt><dd><p>При наличии требуемой функциональности LLVM регистрировать генерируемые функции в <span class="productname">GDB</span>. Это позволяет упростить отладку. Значение по умолчанию — <code class="literal">off</code> (выкл.). Изменить этот параметр можно только при запуске сервера.</p></dd><dt><a id="guc-jit-dump-bitcode"/><span class="term"><code class="varname">jit_dump_bitcode</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.25.1.3" class="indexterm"/></span></dt><dd><p>Записывать сгенерированный <span class="productname">LLVM</span> IR-код в файловую систему, в каталог <a class="xref" href="ch20s02.html#guc-data-directory">data_directory</a>. Это полезно только для работы с внутренним механизмом JIT. Значение по умолчанию — <code class="literal">off</code> (выкл.). Изменить этот параметр может только суперпользователь.</p></dd><dt><a id="guc-jit-expressions"/><span class="term"><code class="varname">jit_expressions</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.26.1.3" class="indexterm"/></span></dt><dd><p>Определяет, будут ли JIT-компилироваться выражения, когда JIT-компиляция включена (см. <a class="xref" href="ch32s02.html" title="32.2. Когда применять JIT?">Раздел 32.2</a>). Значение по умолчанию — <code class="literal">on</code> (вкл.).</p></dd><dt><a id="guc-jit-profiling-support"/><span class="term"><code class="varname">jit_profiling_support</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.27.1.3" class="indexterm"/></span></dt><dd><p>При наличии требуемой функциональности LLVM выдавать данные, необходимые для профилирования с помощью <span class="productname">perf</span> функций, которые генерирует JIT. Выходные файлы записываются в каталог <code class="filename">~/.debug/jit/</code>; удалять их при желании должен сам пользователь. Значение по умолчанию — <code class="literal">off</code> (выкл.). Задать этот параметр можно только при запуске сервера.</p></dd><dt><a id="guc-jit-tuple-deforming"/><span class="term"><code class="varname">jit_tuple_deforming</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.28.1.3" class="indexterm"/></span></dt><dd><p>Определяет, будет ли JIT-компилироваться преобразование кортежей, когда JIT-компиляция включена (см. <a class="xref" href="ch32s02.html" title="32.2. Когда применять JIT?">Раздел 32.2</a>). Значение по умолчанию — <code class="literal">on</code> (вкл.).</p></dd><dt><a id="guc-remove-temp-files-after-crash"/><span class="term"><code class="varname">remove_temp_files_after_crash</code> (<code class="type">boolean</code>) <a id="id-1.6.7.20.3.29.1.3" class="indexterm"/></span></dt><dd><p>Если этот параметр включён (состояние по умолчанию), <span class="productname">PostgreSQL</span> автоматически удаляет временные файлы после сбоя сервера. Если он выключен, файлы будут сохранены и могут использоваться, например, для отладки. Однако повторяющиеся сбои могут привести к накоплению бесполезных файлов. Этот параметр можно задать только в <code class="filename">postgresql.conf</code> или в командной строке при запуске сервера.</p></dd></dl></div></div></body></html>